{"ast":null,"code":"import _objectSpread from\"/Users/nivporat/Desktop/mepelaozen/Frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/nivporat/Desktop/mepelaozen/Frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/nivporat/Desktop/mepelaozen/Frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import axios from\"axios\";import{url}from\"./API\";import jwtDecode from\"jwt-decode\";var _require=require(\"@reduxjs/toolkit\"),createSlice=_require.createSlice,createAsyncThunk=_require.createAsyncThunk;var initialState={token:localStorage.getItem(\"token\"),name:\"\",email:\"\",_id:\"\",isAdmin:\"\",registerStatus:\"\",registerError:\"\",loginStatus:\"\",loginError:\"\",userLoaded:false};export var registerUser=createAsyncThunk(\"auth/registerUser\",/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(user,_ref){var rejectWithValue,token;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:rejectWithValue=_ref.rejectWithValue;_context.prev=1;_context.next=4;return axios.post(\"\".concat(url,\"/register\"),{name:user.name,email:user.email,password:user.password});case 4:token=_context.sent;localStorage.setItem(\"token\",token.data);return _context.abrupt(\"return\",token.data);case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);console.log(_context.t0.response.data);return _context.abrupt(\"return\",rejectWithValue(_context.t0.response.data));case 13:case\"end\":return _context.stop();}},_callee,null,[[1,9]]);}));return function(_x,_x2){return _ref2.apply(this,arguments);};}());export var loginUser=createAsyncThunk(\"auth/loginUser\",/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(user,_ref3){var rejectWithValue,token;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:rejectWithValue=_ref3.rejectWithValue;_context2.prev=1;_context2.next=4;return axios.post(\"\".concat(url,\"/login\"),{email:user.email,password:user.password});case 4:token=_context2.sent;localStorage.setItem(\"token\",token.data);return _context2.abrupt(\"return\",token.data);case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0.response.data);return _context2.abrupt(\"return\",rejectWithValue(_context2.t0.response.data));case 13:case\"end\":return _context2.stop();}},_callee2,null,[[1,9]]);}));return function(_x3,_x4){return _ref4.apply(this,arguments);};}());var authSlice=createSlice({name:\"auth\",initialState:initialState,reducers:{loadUser:function loadUser(state,action){var token=state.token;if(token){var user=jwtDecode(token);return _objectSpread(_objectSpread({},state),{},{token:token,name:user.name,email:user.email,_id:user._id,isAdmin:user.isAdmin,userLoaded:true});}},logoutUser:function logoutUser(state,action){localStorage.removeItem(\"token\");return _objectSpread(_objectSpread({},state),{},{token:\"\",name:\"\",email:\"\",_id:\"\",registerStatus:\"\",registerError:\"\",loginStatus:\"\",loginError:\"\",userLoaded:false});}},extraReducers:function extraReducers(builder){builder.addCase(registerUser.pending,function(state,action){return _objectSpread(_objectSpread({},state),{},{registerStatus:\"pending\"});});builder.addCase(registerUser.fulfilled,function(state,action){if(action.payload){var user=jwtDecode(action.payload);return _objectSpread(_objectSpread({},state),{},{token:action.payload,name:user.name,email:user.email,_id:user._id,isAdmin:user.isAdmin,registerStatus:\"success\"});}else return state;});builder.addCase(registerUser.rejected,function(state,action){return _objectSpread(_objectSpread({},state),{},{registerStatus:\"rejected\",registerError:action.payload});});// ----------------------------------------------------------\nbuilder.addCase(loginUser.pending,function(state,action){return _objectSpread(_objectSpread({},state),{},{loginStatus:\"pending\"});});builder.addCase(loginUser.fulfilled,function(state,action){if(action.payload){var user=jwtDecode(action.payload);return _objectSpread(_objectSpread({},state),{},{token:action.payload,name:user.name,email:user.email,_id:user._id,isAdmin:user.isAdmin,loginStatus:\"success\"});}else return state;});builder.addCase(loginUser.rejected,function(state,action){return _objectSpread(_objectSpread({},state),{},{loginStatus:\"rejected\",loginError:action.payload});});}});var _authSlice$actions=authSlice.actions,loadUser=_authSlice$actions.loadUser,logoutUser=_authSlice$actions.logoutUser;export{loadUser,logoutUser};export default authSlice.reducer;","map":{"version":3,"names":["axios","url","jwtDecode","_require","require","createSlice","createAsyncThunk","initialState","token","localStorage","getItem","name","email","_id","isAdmin","registerStatus","registerError","loginStatus","loginError","userLoaded","registerUser","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","user","_ref","rejectWithValue","wrap","_callee$","_context","prev","next","post","concat","password","sent","setItem","data","abrupt","t0","console","log","response","stop","_x","_x2","apply","arguments","loginUser","_ref4","_callee2","_ref3","_callee2$","_context2","_x3","_x4","authSlice","reducers","loadUser","state","action","_objectSpread","logoutUser","removeItem","extraReducers","builder","addCase","pending","fulfilled","payload","rejected","_authSlice$actions","actions","reducer"],"sources":["/Users/nivporat/Desktop/mepelaozen/Frontend/src/components/store/AuthSlice.js"],"sourcesContent":["import axios from \"axios\";\nimport { url } from \"./API\";\nimport jwtDecode from \"jwt-decode\";\n\nconst { createSlice, createAsyncThunk } = require(\"@reduxjs/toolkit\");\n\n\n const initialState = {\n    token: localStorage.getItem(\"token\"),\n    name:\"\",\n    email:\"\",\n    _id:\"\",\n    isAdmin:\"\",\n    registerStatus:\"\",\n    registerError:\"\",\n    loginStatus:\"\",\n    loginError:\"\",\n    userLoaded:false,\n}\n\n\n\nexport const registerUser =  createAsyncThunk(\n    \"auth/registerUser\",\n   async (user,{rejectWithValue}) => {\n        try {\n        const token = await axios.post(`${url}/register`,{\n                name:user.name,\n                email:user.email,\n                password:user.password\n            });\n            localStorage.setItem(\"token\",token.data);    \n            return token.data;\n        } catch (error) {\n            console.log(error.response.data)\n           return rejectWithValue(error.response.data)\n        }\n    }\n)\n\n\nexport const loginUser =  createAsyncThunk(\n    \"auth/loginUser\",\n   async (user,{rejectWithValue}) => {\n        try {\n        const token = await axios.post(`${url}/login`,{\n                email:user.email,\n                password:user.password\n            })\n            localStorage.setItem(\"token\",token.data)    \n            return token.data\n        } catch (error) {\n            console.log(error.response.data)\n           return rejectWithValue(error.response.data)\n        }\n    }\n)\n\n\n\n\nconst authSlice = createSlice({\n    name:\"auth\",\n    initialState,\n    reducers:{\n        loadUser(state,action){\n            const token = state.token\n            \n            if(token){\n                const user = jwtDecode(token)\n                return{\n                    ...state,\n                    token,\n                    name:user.name,\n                    email:user.email,\n                    _id:user._id,\n                    isAdmin:user.isAdmin,\n                    userLoaded:true\n                }\n            }\n        },\n    \n        logoutUser(state,action){\n            localStorage.removeItem(\"token\")\n            return{\n                ...state,\n                token:\"\",\n                name:\"\",\n                email:\"\",\n                _id:\"\",\n                registerStatus:\"\",\n                registerError:\"\",\n                loginStatus:\"\",\n                loginError:\"\",\n                userLoaded:false,\n            }\n        }\n    },\n\n    extraReducers:(builder)=>{\n        builder.addCase(registerUser.pending,(state,action)=>{\n            return {...state,registerStatus: \"pending\"}\n        });\n\n        builder.addCase(registerUser.fulfilled,(state,action)=>{\n            if(action.payload){\n                const user = jwtDecode(action.payload)\n                return{\n                    ...state,\n                    token:action.payload,\n                    name:user.name,\n                    email:user.email,\n                    _id:user._id,\n                    isAdmin:user.isAdmin,\n                    registerStatus:\"success\"\n                }\n            }else return state\n        });\n\n\n        builder.addCase(registerUser.rejected,(state,action)=>{\n            return{\n                ...state,\n                registerStatus:\"rejected\",\n                registerError:action.payload\n            }\n        });\n\n\n        // ----------------------------------------------------------\n\n        builder.addCase(loginUser.pending,(state,action)=>{\n            return {...state,loginStatus: \"pending\"}\n        });\n\n        builder.addCase(loginUser.fulfilled,(state,action)=>{\n            if(action.payload){\n                const user = jwtDecode(action.payload)\n                return{\n                    ...state,\n                    token:action.payload,\n                    name:user.name,\n                    email:user.email,\n                    _id:user._id,\n                    isAdmin:user.isAdmin,\n                    loginStatus:\"success\"\n                }\n            }else return state\n        });\n\n\n        builder.addCase(loginUser.rejected,(state,action)=>{\n            return{\n                ...state,\n                loginStatus:\"rejected\",\n                loginError:action.payload\n            }\n        });\n\n    },\n\n\n\n    \n})\n\n\n\n\n\n\n\n\nexport const {loadUser,logoutUser} = authSlice.actions\nexport default authSlice.reducer\n\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}